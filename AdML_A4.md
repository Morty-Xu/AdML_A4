# AdML_A4

### 问题描述

任务：（30分）（VAE和GAN二选一）请选择一个生成模型，以[CIFAR-10](https://www.cs.toronto.edu/~kriz/cifar.html)为训练数据，训练一个生成器并从中生成新的图像。要求：代码需有注释，最终提交代码（jupyter notebook文件）和模型，并撰写报告，包含模型原理、实验设置、实验结果分析（例如损失图、生成图像的例子）等。

### 模型原理

本次实验采用的是GAN模型，GAN的主要结构包括一个**生成器**G（Generator）和一个**判别器**D（Discriminator）。

基本流程如下：

- 初始化判别器D的参数 $θ_d $和生成器G的参数 $θ_g$ 。
- 从真实样本中采样 m 个样本 $\{ x_1,x_2,...x_m \} $，从先验分布噪声中采样 m 个噪声样本$ \{ z_1,z_2,...,z_m \} $并通过生成器获取 m 个生成样本$ \{ \tilde{x}^1,\tilde{x}^2,...,\tilde{x}^m \} $。固定生成器G，训练判别器D尽可能好地准确判别真实样本和生成样本，尽可能大地区分正确样本和生成的样本。
- **循环k次更新判别器之后，使用较小的学习率来更新一次生成器的参数**，训练生成器使其尽可能能够减小生成样本与真实样本之间的差距，也相当于尽量使得判别器判别错误。
- 多次更新迭代之后，最终理想情况是使得判别器判别不出样本来自于生成器的输出还是真实的输出。亦即最终样本判别概率均为0.5。

### 实验设置

本次实验使用CIFAR-10数据集。

- 使用 **BCEWithLogitsLoss** 损失函数
- 使用 **Adam** 优化器，学习率设置为0.0002，
- Batch_size设置为64
- 训练15个epoch

### 实验结果分析

损失图如下：

![loss](/Users/morty/Downloads/loss.png)

绿色代表生成网络的损失曲线，蓝色代表判别网络的损失曲线。

生成图像如下：

![99](/Users/morty/Downloads/99.png)

![98](/Users/morty/Downloads/98.png)

可以看到，网络可以正常生成一些图像，但缺点是分辨率较低。